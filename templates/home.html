{% extends 'template.html' %}
{% import "macros/subforms.html" as macros %}

{% block content %}
    <div class="row mt-3">
        <h1 class="text-center display-3 mx-auto">BGB Bazar</h1>
        <div class="alert alert-secondary alert-dismissible fade show mt-3 mx-auto" role="alert">
            Copie e cole o link do jogo, como disponível no <a href="https://boardgamegeek.com/" target="_blank">BGG</a> ou no <a href="https://www.comparajogos.com.br/" target="_blank">ComparaJogos</a>, preencha as demais informações e clique em enviar.
            <br><br>Depois é só copiar o texto formatado abaixo contendo as hashtags e enviar no <a href="https://t.me/bazarbgb/" target="_blank">@BazarBGB</a>!
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <ul class=flashes>
                {% for message in messages %}
                <div class="alert alert-danger" role="alert">
                    <li>{{ message }}</li>
                </div>                    
                {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
    </div>
        {% if data %}      
        <div class="row mt-3">
            <div class="col-lg-10 col-md-12 col-sm-12 col-xs-12 col-12 mx-auto">
                <textarea rows="6" id="tag-area" class="form-control border border-info" readonly>{{ data }}</textarea>
                <br>
                <div class="d-grid gap-2">
                    <button class="btn btn-info" onclick="copy()">Copiar</button>
                </div>
            </div> 
        </div> 
        {% endif %}         
        <div class="row mt-3">
            <div class="col-lg-10 col-md-12 col-sm-12 col-xs-12 col-12 mx-auto">
                <div class="mb-3 mt-3">
                    <div class="form-group">
                        <form id="boardgame-form" action="" method="POST" role="form">
                            {{ form.hidden_tag() }}
                        
                            <div class="row">
                                <div class="col-md-9 col-sm-9 col-xs-9 col-9">
                                    <p>
                                        {{ form.city.label }}<br>
                                        {{ form.city(class_="form-control", placeholder="Mantenha a acentuação correta") }}
                                    </p>
                                </div>
                                <div class="col-md-3 col-sm-3 col-xs-3 col-3">
                                    <p>
                                        {{ form.state.label }}<br>
                                        {{ form.state(class_="form-select") }}
                                    </p>
                                </div>
                            </div> 
                            <div class="d-grid gap-2 mb-5">
                                <a id="add" href="#" class="btn btn-primary btn-lg">Adicionar</a>
                            </div>  
                            <div id="subforms-container">
                                {% for subform in form.boardgames %}
                                    {{ macros.render_boardgame_form(subform, loop.index0) }}
                                {% endfor %}
                            </div>
                        
                            <div class="d-grid gap-2 mb-5">
                                <button class="btn btn-info btn-lg" type="submit">Enviar</button>
                            </div>    
                        </form>  
                        {% if form.errors %}
                            {{ form.errors }}
                        {% endif %}
                    </div>         
                </div>                
            </div>
        </div>
    </div>  
    
    <div hidden>
        {{ macros.render_boardgame_form(_template, '_') }}
    </div>
{% endblock %}
